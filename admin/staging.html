

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Staging System &mdash; Air-Child Payslip 1.0dev documentation</title>
  

  
  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="Air-Child Payslip 1.0dev documentation" href="../index.html"/>
        <link rel="up" title="Administrator’s Guide" href="index.html"/>
        <link rel="next" title="Application Documentation" href="../applications/index.html"/>
        <link rel="prev" title="Administrator’s Guide" href="index.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../contents.html" class="icon icon-home"> Air-Child Payslip
          

          
            
            <img src="../_static/logo.png" class="logo" />
          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Air-Child Payslip Documentation</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../user/index.html">User&#8217;s Guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Administrator&#8217;s Guide</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Staging System</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#heroku-configuration">Heroku Configuration</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#build-configuration">Build Configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="#environment-variables">Environment Variables</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#deployment-prerequisites">Deployment Prerequisites</a></li>
<li class="toctree-l3"><a class="reference internal" href="#automatic-deployment">Automatic Deployment</a></li>
<li class="toctree-l3"><a class="reference internal" href="#post-deployment-activities">Post-Deployment Activities</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../applications/index.html">Application Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../internals/index.html">Project Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ref/index.html">API Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../glossary.html">Glossary</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../contents.html">Air-Child Payslip</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../contents.html">Docs</a> &raquo;</li>
      
          <li><a href="index.html">Administrator&#8217;s Guide</a> &raquo;</li>
      
    <li>Staging System</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/admin/staging.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="staging-system">
<h1>Staging System<a class="headerlink" href="#staging-system" title="Permalink to this headline">¶</a></h1>
<p>The staging system is a Heroku application with automatic deployments from the
<a class="reference internal" href="../internals/git.html#blessed-repository"><span class="std std-ref">blessed Git repository&#8217;s</span></a> master branch.</p>
<p>It is accessible under this URL:</p>
<p><a class="reference external" href="https://ach-payslip-staging.herokuapp.com/">https://ach-payslip-staging.herokuapp.com/</a></p>
<div class="section" id="heroku-configuration">
<h2>Heroku Configuration<a class="headerlink" href="#heroku-configuration" title="Permalink to this headline">¶</a></h2>
<p>Due to security consideration and the specific behaviour of Heroku dynos, some
configuration has to be set up in Heroku to ensure consistent deployment results</p>
<div class="section" id="build-configuration">
<h3>Build Configuration<a class="headerlink" href="#build-configuration" title="Permalink to this headline">¶</a></h3>
<p>The following build configurations are required to build and deploy the application
correctly on a Heroku dyno:</p>
<table border="1" class="docutils">
<colgroup>
<col width="21%" />
<col width="79%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>heroku/python</td>
<td>Standard Python build configuration provided by Heroku</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="environment-variables">
<h3>Environment Variables<a class="headerlink" href="#environment-variables" title="Permalink to this headline">¶</a></h3>
<p>The following environment variables are needed to run the application. If one of them
is not set, the application will not start.</p>
<table border="1" class="docutils">
<colgroup>
<col width="20%" />
<col width="7%" />
<col width="72%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">DATABASE_URL</span></code></td>
<td>String</td>
<td>Will be set automatically by Heroku if set up correctly</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">SECRET_KEY</span></code></td>
<td>String</td>
<td>Needs to be set to provide the secret session key</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="deployment-prerequisites">
<h2>Deployment Prerequisites<a class="headerlink" href="#deployment-prerequisites" title="Permalink to this headline">¶</a></h2>
<p>Automatic deployment will only be triggered for the master branch after all configured
CI checks have been run and provide a green status. Currently, two main checks are set up
for the master branch:</p>
<ul class="simple">
<li>Travis CI will build the application and run all unit tests available</li>
<li>Quantifiedcode will scan all code in the master branch for potential issues</li>
</ul>
</div>
<div class="section" id="automatic-deployment">
<h2>Automatic Deployment<a class="headerlink" href="#automatic-deployment" title="Permalink to this headline">¶</a></h2>
<p>Any commit pushed to the master branch with green prerequisites will be automatically deployed.
This includes deployment of the application alongside with collecting all static files. However,
database migration has to be triggered manually (if needed).</p>
</div>
<div class="section" id="post-deployment-activities">
<h2>Post-Deployment Activities<a class="headerlink" href="#post-deployment-activities" title="Permalink to this headline">¶</a></h2>
<p>In case a commit includes new migrations, the database migration has to be triggered manually.
For security and reliability reasons, automatic migration has been excluded from the build
configuration.</p>
<p>To trigger migration manually, issue the following command on your local computer (Heroku Toolbelt
needs to be installed and set up correctly):</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>heroku run -a ach-payslip-staging python manage.py migrate
</pre></div>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../applications/index.html" class="btn btn-neutral float-right" title="Application Documentation" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral" title="Administrator’s Guide" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, The Air-Child Project.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'1.0dev',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>